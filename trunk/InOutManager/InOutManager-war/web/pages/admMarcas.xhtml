<ui:composition template="index.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">

    <ui:define name="title">
        New page title here
    </ui:define>

    <ui:define name="content">
        <a4j:status onstart="#{rich:component('statPane')}.show()"
        onstop="#{rich:component('statPane')}.hide()" />

        <h:form id="form" prependId="false">
            <rich:dataTable value="#{admMarcasMBean.markSelectItems}" var="mark"
            iterationStatusVar="it" id="table" rows="10">
            
            <rich:column>
                <f:facet name="header">#</f:facet>
                #{it.index}
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.idDispositivo_label}</f:facet>
                <h:outputText id="id" value="#{mark.id}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.fechaMarca_label}</f:facet>
                <h:outputText id="fechaStr" value="#{mark.fechaStr}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.horaMarca_label}</f:facet>
                <h:outputText id="hora" value="#{mark.hora}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.idDispositivo_label}</f:facet>
                <h:outputText id="idDispositivo" value="#{mark.idDispositivo}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.dispositivo_label}</f:facet>
                <h:outputText id="dispositivo" value="#{mark.dispositivo}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.correccionFecha_label}</f:facet>
                <h:outputText id="corrFecha" value="#{mark.correccionFechaStr}" />
            </rich:column>

            <rich:column>
                <f:facet name="header">#{msg.correccionHora_label}</f:facet>
                <h:outputText id="corrHora" value="#{mark.correccionHora}" />
            </rich:column>
                
            <rich:column>
                <f:facet name="header">#{msg.nombreCompletoPersona_label}</f:facet>
                <h:outputText id="nombre" value="#{mark.personaID}" />
            </rich:column>
            
            <rich:column>
                <a4j:commandLink styleClass="no-decor" render="editGrid"
                    execute="@this" oncomplete="#{rich:component('editPane')}.show()">
                    <h:graphicImage styleClass="imageLink" value="../resources/images/edit.gif" alt="edit"/>
                    <a4j:param value="#{it.index}"
                               assignTo="#{admMarcasMBean.currentMarkIndex}" />
                    <f:setPropertyActionListener target="#{admMarcasMBean.editedMark}"
                        value="#{mark}" />
                </a4j:commandLink>
            </rich:column>
            <f:facet name="footer">
                <rich:dataScroller page="#{admMarcasMBean.page}" />
            </f:facet>
        </rich:dataTable>

        <rich:popupPanel id="statPane" autosized="true">
            <h:graphicImage value="../resources/images/indicator.gif" alt="loadIndicator" />
            Please wait...
        </rich:popupPanel>

            <rich:popupPanel header="Detalle Marcas" id="editPane" domElementAttachment="parent" width="400" height="170">
                <h:panelGrid columns="2" id="editGrid">
                    <h:outputLabel value="#{msg.idDispositivo_label}" for="editIdDis"/>
                    <h:outputText id="editIdDis" value="#{admMarcasMBean.editedMark.idDispositivo}" />

                    <h:outputLabel value="#{msg.nombreCompletoPersona_label}" for="editPerId" />
                    <h:outputText id="editPerId" value="#{admMarcasMBean.editedMark.personaID}" />

                    <h:outputLabel value="#{msg.horaMarca_label}" for="editHora" />
                    <h:outputText id="editHora" value="#{admMarcasMBean.editedMark.hora}" />

                    <h:outputLabel value="#{msg.horaMarca_label}" for="editCorrHora" />
                    <h:inputText id="editCorrHora" value="#{admMarcasMBean.editedMark.correccionHora}"/>

                    <h:outputLabel value="#{msg.correccionFecha_label}" for="editCorrFecha"/>
                    <rich:calendar id="editCorrFecha" datePattern="dd/MM/yyyy" style="width:200px"
                                   value="#{admMarcasMBean.editedMark.correccionFecha}">
                    </rich:calendar>


                </h:panelGrid>
                    <a4j:commandButton value="Store" action="#{admMarcasMBean.store}"
                    render="table" execute="editPane"
                    oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('editPane')}.hide();}" />
                <a4j:commandButton value="Cancel"
                    onclick="#{rich:component('editPane')}.hide(); return false;" />
            </rich:popupPanel>
        </h:form>

    </ui:define>
</ui:composition>