<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition template="index.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.prime.com.tr/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="content">
        <fieldset>
            <!--<legend>Ingreso Horario</legend>-->

            <h:form id="formSearch" prependId="false">
                <fieldset>
                    <legend>Filtro de busqueda</legend>
                    <h:panelGrid columns="2">
                        <h:outputLabel value="#{msg.doc_label}" for="doc" />
                        <p:inputMask id="doc" value="#{horariosBean.documento}" mask="99999999"
                                     required="true" requiredMessage="#{msg.doc_required}"/>

                    </h:panelGrid>

                    <h:panelGrid id="panelfilterBtn">
                        <p:commandButton value="#{msg.buscarBtn_label}" update="table,searchMsg"
                                         actionListener="#{horariosBean.searchHorarios}" />
                    </h:panelGrid>
                    <h:message id="searchMsg" styleClass="panelMessages" for="doc"/>
                </fieldset>
            </h:form>


            <h:form id="form" prependId="false">

                    <p:dataTable id="table" var="horario" value="#{horariosBean.horarioSelectItems}" paginator="true" pageLinks="4" rows="5"
                             rowIndexVar="count" height="600" style="width: 900px" paginatorPosition="bottom"
                             rowSelectListener="#{horariosBean.onRowSelect}" styleClass="tableClass" >

                    <f:facet name="header">
                        Gesti√≥n de Horarios
                    </f:facet>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#" />
                        </f:facet>
                        <h:outputText value="#{count}"/>
                    </p:column>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.nombreCompletoPersona_label}" />
                        </f:facet>
                        <h:outputText value="#{horario.persona.nombreCompleto}" />
                    </p:column>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.diaSemana_label}" />
                        </f:facet>
                        <h:outputText value="#{horario.diaSemStr}" />
                    </p:column>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.inicio_Label}" />
                        </f:facet>
                        <h:outputText value="#{horario.inicio}" />
                    </p:column>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.fin_label}" />
                        </f:facet>
                        <h:outputText value="#{horario.fin}" />
                    </p:column>

                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.salon_label}" />
                        </f:facet>
                        <h:outputText value="#{horario.salon}" />
                    </p:column>
                    <p:column style="text-align:center">
                        <f:facet name="header">
                            <h:outputText value="#{msg.salon_label}" />
                        </f:facet>
                        <h:outputText value="#{horario.salon}" />
                    </p:column>
                    <p:column>
                        <p:commandButton update="panelModifica" oncomplete="horarioDialog.show()"
                                         image="ui-icon ui-icon-search" >
                            <f:setPropertyActionListener value="#{horario}"
                                                         target="#{horariosBean.selectedHorario}" />
                        </p:commandButton>
                    </p:column>
                </p:dataTable>
                    <h:panelGrid id="panelBtn2" columns="2">
                        <p:commandLink value="Exportar" action="#{verMarcasBean.xlsGenerator}" oncomplete="excelCallback();"/>
                    </h:panelGrid>

                    <p:dialog header="Modificar Horas" widgetVar="horarioDialog" resizable="false"
                      width="400" height="400" >

                    <h:panelGrid  id="panelModifica" columns="2">

                        <h:outputLabel value="#{msg.nombre_label}" for="nombre"/>
                        <h:outputLabel value="#{horariosBean.selectedHorario.persona.nombreCompleto}" id="nombre"/>


                        <h:outputLabel value="*#{msg.diaSemana_label}" for="diaSemana"/>
                        <h:selectOneMenu id="diaSemana" value="#{horariosBean.diaSemana}" required="true" requiredMessage="#{msg.diaSemana_required}">
                            <f:selectItems value="#{horariosBean.diaSemanaColection}"/>
                        </h:selectOneMenu>

                        <h:outputLabel value="*#{msg.inicio_Label}" for="horaInicio" />
                        <p:inputText id="horaInicio" value="#{horariosBean.selectedHorario.inicio}" />

                        <h:outputLabel value="*#{msg.fin_label}" for="horaFin" />
                        <p:inputText id="horaFin" value="#{horariosBean.selectedHorario.fin}" />

                        <h:outputLabel value="#{msg.salon_label}" for="salon" />
                        <p:inputText id="salon" value="#{horariosBean.selectedHorario.salon}" />


                        <h:outputLabel value="#{msg.obs_label}" for="observaciones" />
                        <p:inputText id="observaciones" value="#{horariosBean.selectedHorario.observaciones}"  />
                    </h:panelGrid>
                    <h:panelGrid id="panelMessages">
                        <h:messages />
                    </h:panelGrid>
                    <h:panelGrid id="panelBtn3">
                        <p:commandButton value="Aceptar"  actionListener="#{horariosBean.guardar}" update="formModifica,infoPanel,panelMessages"/>
                    </h:panelGrid>

                    <h:panelGrid id="infoPanel">
                        <h:outputText value="#{horariosBean.msgSuccess}"/>
                    </h:panelGrid>

            </p:dialog>

            </h:form>

        </fieldset>
    </ui:define>
</ui:composition>

